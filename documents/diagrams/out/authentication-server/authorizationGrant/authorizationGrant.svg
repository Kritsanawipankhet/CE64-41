<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1637px" preserveAspectRatio="none" style="width:1297px;height:1637px;background:#FFFFFF;" version="1.1" viewBox="0 0 1297 1637" width="1297px" zoomAndPan="magnify"><defs><filter height="300%" id="f9iaz5dsm5c0t" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="184" x="481" y="29.4023">Authorization Grant</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="161" x="671" y="29.4023">Seqeunce Diagram</text><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="59.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="299.5" y="1030.1797"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="207.4395" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="199.6191"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="140.1973" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="470.6797"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="71.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="640.1875"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="824.0508"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="103.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="926.9375"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="198.8184" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="1090.1113"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="1504.0586"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="1562.6797"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1083.5" y="244.2402"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1083.5" y="956.248"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1083.5" y="1119.4219"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1083.5" y="1533.3691"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="441.3691"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="711.8086"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="794.7402"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="897.627"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="1288.9297"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="1474.748"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="857.8711" style="stroke:#000000;stroke-width:2.0;" width="1253" x="30" y="756.1191"/><rect fill="#FFFFFF" height="752.6289" style="stroke:none;stroke-width:1.0;" width="1253" x="30" y="861.3613"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="443.2578" style="stroke:#000000;stroke-width:2.0;" width="1233" x="40" y="1163.7324"/><rect fill="#FFFFFF" height="396.6367" style="stroke:none;stroke-width:1.0;" width="1233" x="40" y="1210.3535"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="266.75" style="stroke:#000000;stroke-width:2.0;" width="1213" x="50" y="1333.2402"/><rect fill="#FFFFFF" height="161.5078" style="stroke:none;stroke-width:1.0;" width="1213" x="50" y="1438.4824"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="78" x2="78" y1="123.6875" y2="1630.9902"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="304" x2="304" y1="123.6875" y2="1630.9902"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="727.5" x2="727.5" y1="123.6875" y2="1630.9902"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1088" x2="1088" y1="123.6875" y2="1630.9902"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1198" x2="1198" y1="123.6875" y2="1630.9902"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="60" y="120.7344">User</text><ellipse cx="78.5" cy="50.1992" fill="#FEFECE" filter="url(#f9iaz5dsm5c0t)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M78.5,58.1992 L78.5,85.1992 M65.5,66.1992 L91.5,66.1992 M78.5,85.1992 L65.5,100.1992 M78.5,85.1992 L91.5,100.1992 " fill="none" filter="url(#f9iaz5dsm5c0t)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f9iaz5dsm5c0t)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="259" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="266" y="108.7344">Web Client</text><rect fill="#FEFECE" filter="url(#f9iaz5dsm5c0t)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="162" x="644.5" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="651.5" y="108.7344">Authentication Server</text><rect fill="#FEFECE" filter="url(#f9iaz5dsm5c0t)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="1043" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="1050" y="108.7344">Blockchain</text><rect fill="#FEFECE" filter="url(#f9iaz5dsm5c0t)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="105" x="1144" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="1151" y="108.7344">Crypto Wallet</text><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="59.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="299.5" y="1030.1797"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="207.4395" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="199.6191"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="140.1973" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="470.6797"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="71.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="640.1875"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="824.0508"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="103.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="926.9375"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="198.8184" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="1090.1113"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="1504.0586"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="722.5" y="1562.6797"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1083.5" y="244.2402"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1083.5" y="956.248"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1083.5" y="1119.4219"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1083.5" y="1533.3691"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="441.3691"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="711.8086"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="794.7402"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="897.627"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="1288.9297"/><rect fill="#FFFFFF" filter="url(#f9iaz5dsm5c0t)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1193.5" y="1474.748"/><polygon fill="#A80036" points="292.5,150.998,302.5,154.998,292.5,158.998,296.5,154.998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="78.5" x2="298.5" y1="154.998" y2="154.998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="85.5" y="150.2559">(1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="108.5" y="150.2559">User Authentication Request</text><polygon fill="#A80036" points="710.5,195.6191,720.5,199.6191,710.5,203.6191,714.5,199.6191" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="716.5" y1="199.6191" y2="199.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="311.5" y="187.2217">(2)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="334.5" y="179.5664">Redirect to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="334.5" y="194.877">GET /oauth/authorize?</text><polygon fill="#A80036" points="1071.5,240.2402,1081.5,244.2402,1071.5,248.2402,1075.5,244.2402" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732.5" x2="1077.5" y1="244.2402" y2="244.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="739.5" y="231.8428">(3)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="762.5" y="224.1875">Client credentials request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309" x="762.5" y="239.498">[response_type,client_id,redirect_uri,scope,state]</text><polygon fill="#A80036" points="743.5,269.5508,733.5,273.5508,743.5,277.5508,739.5,273.5508" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="737.5" x2="1087.5" y1="273.5508" y2="273.5508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="749.5" y="268.8086">(4)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="772.5" y="268.8086">Client credentials response</text><polygon fill="#A80036" points="89.5,338.4824,79.5,342.4824,89.5,346.4824,85.5,342.4824" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83.5" x2="721.5" y1="342.4824" y2="342.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="95.5" y="322.4297">Authentication denied</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="95.5" y="337.7402">/Error Page [400] response</text><polygon fill="#A80036" points="89.5,403.0586,79.5,407.0586,89.5,411.0586,85.5,407.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83.5" x2="726.5" y1="407.0586" y2="407.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="95.5" y="394.6611">(5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="118.5" y="387.0059">Authentication From</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="118.5" y="402.3164">/Grant Page [200] response</text><path d="M737,370.4375 L737,410.4375 L1099,410.4375 L1099,380.4375 L1089,370.4375 L737,370.4375 " fill="#FBFB77" filter="url(#f9iaz5dsm5c0t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1089,370.4375 L1089,380.4375 L1099,380.4375 L1089,370.4375 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337" x="743" y="388.0059">Support wallet : Metamask , CoinBase , WalletConnect</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="743" y="403.3164">Support chain Id: 3</text><polygon fill="#A80036" points="1181.5,437.3691,1191.5,441.3691,1181.5,445.3691,1185.5,441.3691" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78.5" x2="1187.5" y1="441.3691" y2="441.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="85.5" y="436.627">(6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="108.5" y="436.627">User connect wallet request</text><polygon fill="#A80036" points="743.5,466.6797,733.5,470.6797,743.5,474.6797,739.5,470.6797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="737.5" x2="1197.5" y1="470.6797" y2="470.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="749.5" y="465.9375">(7)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="772.5" y="465.9375">Wallet credentials response</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732.5" x2="774.5" y1="499.9902" y2="499.9902"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="774.5" x2="774.5" y1="499.9902" y2="512.9902"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="733.5" x2="774.5" y1="512.9902" y2="512.9902"/><polygon fill="#A80036" points="743.5,508.9902,733.5,512.9902,743.5,516.9902,739.5,512.9902" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="739.5" y="495.248">(8)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="762.5" y="495.248">Wallet verification and chain Id</text><polygon fill="#A80036" points="89.5,562.6113,79.5,566.6113,89.5,570.6113,85.5,566.6113" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83.5" x2="721.5" y1="566.6113" y2="566.6113"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="95.5" y="561.8691">Authentication denied</text><polygon fill="#A80036" points="89.5,606.877,79.5,610.877,89.5,614.877,85.5,610.877" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83.5" x2="726.5" y1="610.877" y2="610.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="95.5" y="606.1348">(9)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="118.5" y="606.1348">User wallet connected response</text><polygon fill="#A80036" points="710.5,636.1875,720.5,640.1875,710.5,644.1875,714.5,640.1875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78.5" x2="716.5" y1="640.1875" y2="640.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="85.5" y="635.4453">(10)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="117.5" y="635.4453">Authorization request</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732.5" x2="774.5" y1="669.498" y2="669.498"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="774.5" x2="774.5" y1="669.498" y2="682.498"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="733.5" x2="774.5" y1="682.498" y2="682.498"/><polygon fill="#A80036" points="743.5,678.498,733.5,682.498,743.5,686.498,739.5,682.498" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="739.5" y="664.7559">(11)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292" x="771.5" y="664.7559">Generate grant authorization code and encrypt</text><polygon fill="#A80036" points="1181.5,707.8086,1191.5,711.8086,1181.5,715.8086,1185.5,711.8086" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="727.5" x2="1187.5" y1="711.8086" y2="711.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="734.5" y="707.0664">(12)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266" x="766.5" y="707.0664">Generate transaction signature , Authorize</text><polygon fill="#A80036" points="89.5,737.1191,79.5,741.1191,89.5,745.1191,85.5,741.1191" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83.5" x2="1197.5" y1="741.1191" y2="741.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="95.5" y="736.377">(13)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="127.5" y="736.377">Response transaction signature and wait for user confirmation</text><path d="M30,756.1191 L92,756.1191 L92,763.1191 L82,773.1191 L30,773.1191 L30,756.1191 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="857.8711" style="stroke:#000000;stroke-width:2.0;" width="1253" x="30" y="756.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="45" y="769.6875">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="235" x="107" y="768.7539">[User denied transaction signature (false)]</text><polygon fill="#A80036" points="1181.5,790.7402,1191.5,794.7402,1181.5,798.7402,1185.5,794.7402" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78.5" x2="1187.5" y1="794.7402" y2="794.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="85.5" y="789.998">User denied transaction signature</text><polygon fill="#A80036" points="743.5,820.0508,733.5,824.0508,743.5,828.0508,739.5,824.0508" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="737.5" x2="1197.5" y1="824.0508" y2="824.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="749.5" y="819.3086">Denied authorize transation signature</text><polygon fill="#A80036" points="89.5,849.3613,79.5,853.3613,89.5,857.3613,85.5,853.3613" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83.5" x2="726.5" y1="853.3613" y2="853.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="95.5" y="848.6191">Authorization denied</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30" x2="1283" y1="862.3613" y2="862.3613"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="251" x="35" y="872.9961">[User confirmed transaction signature (true)]</text><polygon fill="#A80036" points="1181.5,893.627,1191.5,897.627,1181.5,901.627,1185.5,897.627" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78.5" x2="1187.5" y1="897.627" y2="897.627"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="85.5" y="892.8848">(14)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="117.5" y="892.8848">User confirmed transaction signature</text><polygon fill="#A80036" points="743.5,922.9375,733.5,926.9375,743.5,930.9375,739.5,926.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="737.5" x2="1197.5" y1="926.9375" y2="926.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="749.5" y="922.1953">(15)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267" x="781.5" y="922.1953">Confirmed authorize transaction signature</text><polygon fill="#A80036" points="1071.5,952.248,1081.5,956.248,1071.5,960.248,1075.5,956.248" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732.5" x2="1077.5" y1="956.248" y2="956.248"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="739.5" y="951.5059">(16)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="771.5" y="951.5059">Send authorization credentials encrypted</text><polygon fill="#A80036" points="743.5,981.5586,733.5,985.5586,743.5,989.5586,739.5,985.5586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="737.5" x2="1087.5" y1="985.5586" y2="985.5586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="749.5" y="980.8164">(17)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="781.5" y="980.8164">Successful transaction response</text><polygon fill="#A80036" points="320.5,1026.1797,310.5,1030.1797,320.5,1034.1797,316.5,1030.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="314.5" x2="726.5" y1="1030.1797" y2="1030.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="326.5" y="1017.7822">(18)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279" x="358.5" y="1010.127">Authorized and authorization code response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="362" x="358.5" y="1025.4375">Redirect to uri/callback?code=[authorization_code]&amp;state</text><polygon fill="#A80036" points="710.5,1086.1113,720.5,1090.1113,710.5,1094.1113,714.5,1090.1113" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="304.5" x2="716.5" y1="1090.1113" y2="1090.1113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="311.5" y="1070.0586">(19)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="343.5" y="1054.748">Access token request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="343.5" y="1070.0586">POST /oauth/token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="327" x="343.5" y="1085.3691">[client_id,client_secret,grant_type,code,redirect_uri]</text><polygon fill="#A80036" points="1071.5,1115.4219,1081.5,1119.4219,1071.5,1123.4219,1075.5,1119.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732.5" x2="1077.5" y1="1119.4219" y2="1119.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="739.5" y="1114.6797">(20)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="771.5" y="1114.6797">Verify authorization and data accuracy</text><polygon fill="#A80036" points="743.5,1144.7324,733.5,1148.7324,743.5,1152.7324,739.5,1148.7324" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="737.5" x2="1087.5" y1="1148.7324" y2="1148.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="749.5" y="1143.9902">(21)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="781.5" y="1143.9902">Confirmation status response</text><path d="M40,1163.7324 L102,1163.7324 L102,1170.7324 L92,1180.7324 L40,1180.7324 L40,1163.7324 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="443.2578" style="stroke:#000000;stroke-width:2.0;" width="1233" x="40" y="1163.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="55" y="1177.3008">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="229" x="117" y="1176.3672">[Invalid authorization credentials (false)]</text><polygon fill="#A80036" points="315.5,1198.3535,305.5,1202.3535,315.5,1206.3535,311.5,1202.3535" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="309.5" x2="721.5" y1="1202.3535" y2="1202.3535"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="321.5" y="1197.6113">Access token request denied</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="1273" y1="1211.3535" y2="1211.3535"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="214" x="45" y="1221.9883">[Valid authorization credentials (true)]</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732.5" x2="774.5" y1="1246.6191" y2="1246.6191"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="774.5" x2="774.5" y1="1246.6191" y2="1259.6191"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="733.5" x2="774.5" y1="1259.6191" y2="1259.6191"/><polygon fill="#A80036" points="743.5,1255.6191,733.5,1259.6191,743.5,1263.6191,739.5,1259.6191" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="739.5" y="1241.877">(22)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256" x="771.5" y="1241.877">Generate grant access token and encrypt</text><polygon fill="#A80036" points="1181.5,1284.9297,1191.5,1288.9297,1181.5,1292.9297,1185.5,1288.9297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="727.5" x2="1187.5" y1="1288.9297" y2="1288.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="734.5" y="1284.1875">(23)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284" x="766.5" y="1284.1875">Geneate transaction signature , Access token</text><polygon fill="#A80036" points="89.5,1314.2402,79.5,1318.2402,89.5,1322.2402,85.5,1318.2402" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83.5" x2="1197.5" y1="1318.2402" y2="1318.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="95.5" y="1313.498">(24)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="127.5" y="1313.498">Response transaction signature and wait for user confirmation</text><path d="M50,1333.2402 L112,1333.2402 L112,1340.2402 L102,1350.2402 L50,1350.2402 L50,1333.2402 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="266.75" style="stroke:#000000;stroke-width:2.0;" width="1213" x="50" y="1333.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="65" y="1346.8086">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="235" x="127" y="1345.875">[User denied transaction signature (false)]</text><polygon fill="#A80036" points="1186.5,1367.8613,1196.5,1371.8613,1186.5,1375.8613,1190.5,1371.8613" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78.5" x2="1192.5" y1="1371.8613" y2="1371.8613"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="85.5" y="1367.1191">User denied transaction signature</text><polygon fill="#A80036" points="738.5,1397.1719,728.5,1401.1719,738.5,1405.1719,734.5,1401.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732.5" x2="1197.5" y1="1401.1719" y2="1401.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312" x="744.5" y="1396.4297">Denied access token grant, Transaction signature</text><polygon fill="#A80036" points="315.5,1426.4824,305.5,1430.4824,315.5,1434.4824,311.5,1430.4824" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="309.5" x2="726.5" y1="1430.4824" y2="1430.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="321.5" y="1425.7402">Access token request denied</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50" x2="1263" y1="1439.4824" y2="1439.4824"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="266" x="55" y="1450.1172">[User confirmation transaction signature (true)]</text><polygon fill="#A80036" points="1181.5,1470.748,1191.5,1474.748,1181.5,1478.748,1185.5,1474.748" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78.5" x2="1187.5" y1="1474.748" y2="1474.748"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="85.5" y="1470.0059">(25)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="117.5" y="1470.0059">User confirmed transaction signature</text><polygon fill="#A80036" points="743.5,1500.0586,733.5,1504.0586,743.5,1508.0586,739.5,1504.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="737.5" x2="1197.5" y1="1504.0586" y2="1504.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="749.5" y="1499.3164">(26)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300" x="781.5" y="1499.3164">Confirmed transaction signature , Access token</text><polygon fill="#A80036" points="1071.5,1529.3691,1081.5,1533.3691,1071.5,1537.3691,1075.5,1533.3691" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="727.5" x2="1077.5" y1="1533.3691" y2="1533.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="734.5" y="1528.627">(27)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="766.5" y="1528.627">Send access token credentials encrypted</text><polygon fill="#A80036" points="743.5,1558.6797,733.5,1562.6797,743.5,1566.6797,739.5,1562.6797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="737.5" x2="1087.5" y1="1562.6797" y2="1562.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="749.5" y="1557.9375">(28)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="781.5" y="1557.9375">Successful transaction response</text><polygon fill="#A80036" points="315.5,1587.9902,305.5,1591.9902,315.5,1595.9902,311.5,1591.9902" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="309.5" x2="726.5" y1="1591.9902" y2="1591.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="321.5" y="1587.248">(29)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269" x="353.5" y="1587.248">Grant access token,refresh token response</text><!--MD5=[074f7eab9483460e9175e29ebd314480]
@startuml authorizationGrant
title **Authorization Grant** Seqeunce Diagram
hide footbox
actor User
autonumber "<b>(0)"
"User" -> "Web Client" : User Authentication Request
"Web Client" -> "Authentication Server" ++:  Redirect to \nGET /oauth/authorize?
"Authentication Server" - -> "Blockchain" ++: Client credentials request\n[response_type,client_id,redirect_uri,scope,state]
"Blockchain" - -> "Authentication Server" - -: Client credentials response
alt Invalid client credentials (false)
    autonumber stop
    "Authentication Server" - -> "User": Authentication denied \n/Error Page [400] response
else Valid client credentials (true)
    autonumber resume
    "Authentication Server" - -> "User" - -: Authentication From\n/Grant Page [200] response
    note right: Support wallet : Metamask , CoinBase , WalletConnect \nSupport chain Id: 3
    "User" - -> "Crypto Wallet" ++: User connect wallet request
    "Crypto Wallet" - -> "Authentication Server" - -++:  Wallet credentials response
    "Authentication Server" - -> "Authentication Server" : Wallet verification and chain Id
    alt Invalid wallet credential (false)
        autonumber stop
        "Authentication Server" - -> "User" : Authentication denied
    else  Valid wallet credential (true) 
        autonumber resume
        "Authentication Server" - -> "User" - -: User wallet connected response
        "User" - -> "Authentication Server" ++: Authorization request
        "Authentication Server" - -> "Authentication Server" : Generate grant authorization code and encrypt
        "Authentication Server" - -> "Crypto Wallet" - -++: Generate transaction signature , Authorize
        "Crypto Wallet" - -> "User" - -:  Response transaction signature and wait for user confirmation
        alt  User denied transaction signature (false)
            autonumber stop
            "User" - -> "Crypto Wallet" ++: User denied transaction signature
            "Crypto Wallet" - -> "Authentication Server" - -++: Denied authorize transation signature
            "Authentication Server" - -> "User" - -: Authorization denied
        else User confirmed transaction signature (true)
            autonumber resume
            "User" - -> "Crypto Wallet" ++: User confirmed transaction signature
            "Crypto Wallet" - -> "Authentication Server" - -++: Confirmed authorize transaction signature
            "Authentication Server" - -> "Blockchain" ++: Send authorization credentials encrypted
            "Blockchain" - -> "Authentication Server" - -: Successful transaction response
            "Authentication Server" - -> "Web Client" - -++: Authorized and authorization code response \nRedirect to uri/callback?code=[authorization_code]&state
            "Web Client" - -> "Authentication Server" - -++: Access token request \nPOST /oauth/token\n[client_id,client_secret,grant_type,code,redirect_uri]
            "Authentication Server" - -> "Blockchain" ++: Verify authorization and data accuracy  
            "Blockchain" - -> "Authentication Server" - -: Confirmation status response
            alt Invalid authorization credentials (false)
                 autonumber stop
                "Authentication Server" - -> "Web Client" : Access token request denied 
            else Valid authorization credentials (true)
                autonumber resume
                "Authentication Server" - -> "Authentication Server" : Generate grant access token and encrypt
                "Authentication Server" - -> "Crypto Wallet" - -++: Geneate transaction signature , Access token
                "Crypto Wallet" - -> "User" - -: Response transaction signature and wait for user confirmation  
                alt User denied transaction signature (false)
                    autonumber stop
                    "User" - -> "Crypto Wallet" : User denied transaction signature
                    "Crypto Wallet" - -> "Authentication Server" : Denied access token grant, Transaction signature
                    "Authentication Server" - -> "Web Client" : Access token request denied
                else User confirmation transaction signature (true)
                    autonumber resume
                    "User" - -> "Crypto Wallet" ++: User confirmed transaction signature
                    "Crypto Wallet" - -> "Authentication Server" - -++: Confirmed transaction signature , Access token
                    "Authentication Server" - -> "Blockchain" - -++: Send access token credentials encrypted
                    "Blockchain" - -> "Authentication Server" - -++: Successful transaction response
                    "Authentication Server" - -> "Web Client" - -: Grant access token,refresh token response
         end
       
    end
end
@enduml

PlantUML version 1.2022.0(Tue Jan 11 23:16:42 ICT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: TH
--></g></svg>